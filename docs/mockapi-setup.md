# MockAPI.io Setup Guide

This guide explains how to configure [mockapi.io](https://mockapi.io) as the backend for SuccessBoard's Overview and Customers Hub.

## Overview

SuccessBoard uses a mock API backend for development and demonstration purposes. The API domain model is defined in `src/modules/api/types.ts` and the client is implemented in `src/modules/api/mockapi.ts`.

**How the app uses the API:**

- **Overview Dashboard**: Uses `/metrics` for aggregated KPIs and summary data
- **Customers Hub**: Uses `/customers` for the customer list and `/frameworks` for segment filters
- **Customer Detail** (future): Will use `/interactions` and `/documents` for activity history

When `NEXT_PUBLIC_MOCKAPI_BASE_URL` is not configured or the API fails, the app automatically falls back to demo data and displays a banner.

---

## Prerequisites

1. Create a free account at [mockapi.io](https://mockapi.io)
2. Create a new project (e.g., "SuccessBoard")
3. Note your project's base URL, which will look like:
   ```
   https://64abc123def456.mockapi.io/api/v1
   ```

---

## Resource Configuration

Create the following resources in your mockapi.io project. For each resource:

1. Click **"New Resource"**
2. Set the resource name (use plural, lowercase names)
3. Configure the schema fields as described below
4. Import seed data from `tools/mockapi-seeds/`

### 1. customers

**Path:** `/customers`

**Schema Fields:**

| Field                   | Type   | Notes                                                                          |
| ----------------------- | ------ | ------------------------------------------------------------------------------ |
| `id`                    | String | Auto-generated by mockapi                                                      |
| `name`                  | String | Display name                                                                   |
| `companyName`           | String | Legal company name                                                             |
| `customerType`          | String | `trial`, `paying`, `enterprise`, `strategic`, `partner`, `churned`             |
| `tier`                  | String | `smb`, `mid-market`, `enterprise`, `strategic`                                 |
| `mrr`                   | Number | Monthly Recurring Revenue in cents                                             |
| `arr`                   | Number | Annual Recurring Revenue in cents                                              |
| `currency`              | String | `USD`, `EUR`, `GBP`, `CAD`, `AUD`                                              |
| `lifecycleStage`        | String | `prospect`, `trial`, `onboarding`, `active`, `expanding`, `at-risk`, `churned` |
| `healthScore`           | Number | 0-100                                                                          |
| `healthTrend`           | String | `up`, `down`, `flat`                                                           |
| `primaryFrameworkId`    | String | Optional reference to framework                                                |
| `csmId`                 | String | CSM identifier                                                                 |
| `csmName`               | String | CSM display name                                                               |
| `keyContacts`           | Object | Array of contact objects                                                       |
| `lastInteractionAt`     | String | ISO 8601 date                                                                  |
| `nextActionDueAt`       | String | ISO 8601 date                                                                  |
| `nextActionDescription` | String | Action description                                                             |
| `riskFlags`             | Object | Array of risk flag strings                                                     |
| `industry`              | String | Industry vertical                                                              |
| `website`               | String | Company URL                                                                    |
| `employeeCount`         | Number | Company size                                                                   |
| `logoUrl`               | String | Logo image URL                                                                 |
| `renewalDate`           | String | ISO 8601 date                                                                  |
| `daysUntilRenewal`      | Number | Days until renewal                                                             |
| `npsScore`              | Number | -100 to 100                                                                    |
| `createdAt`             | String | ISO 8601 date                                                                  |
| `updatedAt`             | String | ISO 8601 date                                                                  |

**Import:** Use `tools/mockapi-seeds/customers.json`

---

### 2. frameworks

**Path:** `/frameworks`

**Schema Fields:**

| Field               | Type    | Notes                                                                                            |
| ------------------- | ------- | ------------------------------------------------------------------------------------------------ |
| `id`                | String  | Auto-generated                                                                                   |
| `name`              | String  | Framework/segment name                                                                           |
| `description`       | String  | Detailed description                                                                             |
| `type`              | String  | `segment`, `framework`, `playbook`, `scorecard`                                                  |
| `criteria`          | Object  | Filter criteria object                                                                           |
| `businessDimension` | String  | `churn-risk`, `growth`, `adoption`, `expansion`, `onboarding`, `renewal`, `health`, `engagement` |
| `color`             | String  | Hex color code                                                                                   |
| `badgeStyle`        | String  | `solid`, `outline`, `subtle`                                                                     |
| `isDefault`         | Boolean | System default flag                                                                              |
| `isRecommended`     | Boolean | Recommended flag                                                                                 |
| `customerCount`     | Number  | Customers in segment                                                                             |
| `sortOrder`         | Number  | Display order                                                                                    |
| `createdAt`         | String  | ISO 8601 date                                                                                    |
| `updatedAt`         | String  | ISO 8601 date                                                                                    |

**Import:** Use `tools/mockapi-seeds/frameworks.json`

---

### 3. interactions

**Path:** `/interactions`

**Schema Fields:**

| Field                | Type    | Notes                                                                                                                                                                                             |
| -------------------- | ------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `id`                 | String  | Auto-generated                                                                                                                                                                                    |
| `customerId`         | String  | Reference to customer                                                                                                                                                                             |
| `type`               | String  | `email`, `call`, `meeting`, `qbr`, `ebr`, `onboarding-call`, `training`, `support-ticket`, `implementation`, `renewal-discussion`, `escalation`, `executive-briefing`, `product-feedback`, `note` |
| `channel`            | String  | `email`, `phone`, `video`, `in-person`, `chat`, `support-portal`, `slack`, `other`                                                                                                                |
| `date`               | String  | ISO 8601 date                                                                                                                                                                                     |
| `summary`            | String  | Brief summary                                                                                                                                                                                     |
| `notes`              | String  | Detailed notes                                                                                                                                                                                    |
| `sentiment`          | String  | `positive`, `neutral`, `negative`                                                                                                                                                                 |
| `durationMinutes`    | Number  | Call/meeting duration                                                                                                                                                                             |
| `ownerId`            | String  | CSM identifier                                                                                                                                                                                    |
| `ownerName`          | String  | CSM display name                                                                                                                                                                                  |
| `customerAttendees`  | Object  | Array of attendee names                                                                                                                                                                           |
| `actionItems`        | Object  | Array of action items                                                                                                                                                                             |
| `requiresFollowUp`   | Boolean | Follow-up flag                                                                                                                                                                                    |
| `relatedDocumentIds` | Object  | Array of document IDs                                                                                                                                                                             |
| `createdAt`          | String  | ISO 8601 date                                                                                                                                                                                     |
| `updatedAt`          | String  | ISO 8601 date                                                                                                                                                                                     |

**Import:** Use `tools/mockapi-seeds/interactions.json`

---

### 4. documents

**Path:** `/documents`

**Schema Fields:**

| Field             | Type   | Notes                                                                                                                                                                                                                    |
| ----------------- | ------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `id`              | String | Auto-generated                                                                                                                                                                                                           |
| `customerId`      | String | Reference to customer                                                                                                                                                                                                    |
| `title`           | String | Document title                                                                                                                                                                                                           |
| `documentType`    | String | `success-plan`, `qbr-deck`, `ebr-deck`, `onboarding-plan`, `implementation-plan`, `internal-brief`, `playbook`, `health-report`, `renewal-proposal`, `expansion-proposal`, `executive-summary`, `meeting-notes`, `other` |
| `frameworkId`     | String | Optional framework reference                                                                                                                                                                                             |
| `status`          | String | `draft`, `in-review`, `approved`, `shared`, `signed`, `archived`, `superseded`                                                                                                                                           |
| `description`     | String | Document description                                                                                                                                                                                                     |
| `documentUrl`     | String | External URL                                                                                                                                                                                                             |
| `fileSizeBytes`   | Number | File size                                                                                                                                                                                                                |
| `mimeType`        | String | MIME type                                                                                                                                                                                                                |
| `version`         | Number | Version number                                                                                                                                                                                                           |
| `ownerId`         | String | Owner identifier                                                                                                                                                                                                         |
| `ownerName`       | String | Owner display name                                                                                                                                                                                                       |
| `collaboratorIds` | Object | Array of collaborator IDs                                                                                                                                                                                                |
| `tags`            | Object | Array of tag strings                                                                                                                                                                                                     |
| `sharedAt`        | String | ISO 8601 date                                                                                                                                                                                                            |
| `signedAt`        | String | ISO 8601 date                                                                                                                                                                                                            |
| `createdAt`       | String | ISO 8601 date                                                                                                                                                                                                            |
| `updatedAt`       | String | ISO 8601 date                                                                                                                                                                                                            |

**Import:** Use `tools/mockapi-seeds/documents.json`

---

### 5. templates

**Path:** `/templates`

**Schema Fields:**

| Field                | Type    | Notes                                                                                                                              |
| -------------------- | ------- | ---------------------------------------------------------------------------------------------------------------------------------- |
| `id`                 | String  | Auto-generated                                                                                                                     |
| `name`               | String  | Template name                                                                                                                      |
| `templateType`       | String  | Same as `documentType`                                                                                                             |
| `description`        | String  | Template description                                                                                                               |
| `category`           | String  | `qbr`, `ebr`, `onboarding`, `implementation`, `renewal`, `expansion`, `health-review`, `executive-briefing`, `playbook`, `general` |
| `defaultFrameworkId` | String  | Default framework reference                                                                                                        |
| `usageCount`         | Number  | Times used                                                                                                                         |
| `lastUsedAt`         | String  | ISO 8601 date                                                                                                                      |
| `templateUrl`        | String  | Template file URL                                                                                                                  |
| `previewImageUrl`    | String  | Preview image URL                                                                                                                  |
| `isSystemTemplate`   | Boolean | System template flag                                                                                                               |
| `isRecommended`      | Boolean | Recommended flag                                                                                                                   |
| `tags`               | Object  | Array of tag strings                                                                                                               |
| `createdById`        | String  | Creator identifier                                                                                                                 |
| `createdAt`          | String  | ISO 8601 date                                                                                                                      |
| `updatedAt`          | String  | ISO 8601 date                                                                                                                      |

**Import:** Use `tools/mockapi-seeds/templates.json`

---

### 6. metrics

**Path:** `/metrics`

> **Note:** This resource returns a single object (or array with one item) containing aggregated metrics.

**Schema Fields:**

| Field                   | Type   | Notes                       |
| ----------------------- | ------ | --------------------------- |
| `id`                    | String | Auto-generated              |
| `totalCustomers`        | Number | Total active customers      |
| `totalMrr`              | Number | Total MRR in cents          |
| `totalArr`              | Number | Total ARR in cents          |
| `currency`              | String | Currency code               |
| `churnRate`             | Number | Monthly churn rate (0-1)    |
| `churnTrend`            | String | `up`, `down`, `flat`        |
| `atRiskCount`           | Number | At-risk customer count      |
| `vipCount`              | Number | VIP/strategic count         |
| `trialCount`            | Number | Trial customer count        |
| `onboardingCount`       | Number | Onboarding count            |
| `avgHealthScore`        | Number | Average health (0-100)      |
| `healthTrend`           | String | `up`, `down`, `flat`        |
| `expansionPipelineMrr`  | Number | Expansion pipeline in cents |
| `netRevenueRetention`   | Number | NRR (0-2, where 1 = 100%)   |
| `grossRevenueRetention` | Number | GRR (0-1)                   |
| `avgNpsScore`           | Number | Average NPS (-100 to 100)   |
| `segmentBreakdown`      | Object | Array of segment metrics    |
| `tierBreakdown`         | Object | Array of tier metrics       |
| `lifecycleBreakdown`    | Object | Array of lifecycle metrics  |
| `lastUpdatedAt`         | String | ISO 8601 date               |

**Import:** Use `tools/mockapi-seeds/metrics.json`

---

## Importing Seed Data

For each resource:

1. Create the resource in mockapi.io with the schema above
2. Click on the resource to open it
3. Click the **"Data"** tab
4. Click **"Import"** or use the bulk import feature
5. Paste the contents of the corresponding JSON file from `tools/mockapi-seeds/`
6. Save the imported data

**Tip:** mockapi.io may auto-generate IDs. If you want to preserve the IDs from the seed files, you may need to manually set them or use the API to POST each record.

---

## Environment Configuration

Once your mockapi.io project is set up:

1. Copy your project's base URL
2. Create or edit `.env.local` in the project root:

```bash
NEXT_PUBLIC_MOCKAPI_BASE_URL=https://YOUR_PROJECT_ID.mockapi.io/api/v1
```

3. Restart the Next.js dev server

**Example:**

```bash
NEXT_PUBLIC_MOCKAPI_BASE_URL=https://64abc123def456.mockapi.io/api/v1
```

---

## Verification

After configuration:

1. Start the dev server: `npm run dev`
2. Open the Overview page - it should display metrics from `/metrics`
3. Open the Customers Hub - it should display customers from `/customers`
4. If the API is unreachable, the app will show a demo data banner

---

## Troubleshooting

### API not connecting

- Verify `NEXT_PUBLIC_MOCKAPI_BASE_URL` is set correctly in `.env.local`
- Ensure the URL includes the full path (e.g., `/api/v1`)
- Check browser console for CORS or network errors

### Data not displaying correctly

- Verify seed data was imported successfully
- Check that field names match exactly (case-sensitive)
- Ensure arrays are properly formatted as JSON arrays

### Demo banner still showing

- The banner appears when the API is not configured or returns errors
- Check that all required resources exist in mockapi.io
- Verify the `/metrics` endpoint returns valid data

---

## Seed Data Summary

| Resource       | Records | Description                                       |
| -------------- | ------- | ------------------------------------------------- |
| `customers`    | 16      | Mix of tiers, lifecycle stages, and health scores |
| `frameworks`   | 10      | Segments, frameworks, and playbooks               |
| `interactions` | 16      | Various interaction types and sentiments          |
| `documents`    | 14      | Different document types and statuses             |
| `templates`    | 12      | System and custom templates                       |
| `metrics`      | 1       | Aggregated dashboard metrics                      |

---

## Related Files

- **Domain Types:** `src/modules/api/types.ts`
- **API Client:** `src/modules/api/mockapi.ts`
- **View Mappers:** `src/modules/api/mappers.ts`
- **Seed Data:** `tools/mockapi-seeds/*.json`
